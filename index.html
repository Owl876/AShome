<!DOCTYPE html>
<html>
<head>
    <title>Messenger</title>
</head>
<body>
<h1>Messenger</h1>
<form id="loginForm">
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button type="button" onclick="login()">Login</button>
</form>

<div id="chatWindow" style="display:none;">
    <textarea id="chatBox" readonly></textarea><br>
    <input type="text" id="messageInput" placeholder="Type a message">
    <button type="button" onclick="sendMessage()">Send</button>
</div>

<script>
    let userId;

    function login() {
        let username = document.getElementById("username").value;
        let password = document.getElementById("password").value;
        fetch("/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username: username, password: password })
        }).then(response => response.json()).then(data => {
            if (data.user_id) {
                userId = data.user_id;
                document.getElementById("chatWindow").style.display = "block";
                document.getElementById("loginForm").style.display = "none";
            }
        });
    }

    function sendMessage() {
        let content = document.getElementById("messageInput").value;
        fetch("/send_message", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ sender_id: userId, recipient_id: 1, content: content })
        }).then(response => response.json()).then(data => {
            document.getElementById("messageInput").value = '';
        });
    }
</script>
</body>
</html>
